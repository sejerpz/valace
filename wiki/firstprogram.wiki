#labels Featured
My first Vala program for Windows CE

= Introduction =

So you have installed ValaCE and you want use it? Let's go and write a simple Vala program with ValaForms a.k.a. VForms.


= Project structure =

If you followed the Compile instruction you should ended with a copy of all the required library and headers installed in the _wince_ subfolder (e.g. , so now you just need to create a simple folder to store your first program.

So just do a:

{{{mkdir valace-example1}}}

and create there a simple *Makefile* file with the following content:
{{{
###########################################################
# Simple Makefile for ValaForms
###########################################################

# Installation directory of the CE-GCC compiler
MINGW_PATH= ${HOME}/opt/mingw32ce

# Installation directory of ValaCE
VALACE_PATH= ${HOME}/Src/vala/valace/svn/wince

############################################################
VAPIDIR= ${VALACE_PATH}/share/valace/vapi
GLIB_INCLUDE = ${VALACE_PATH}/include/glibce-2.0
GOBJECT_INCLUDE = ${VALACE_PATH}/include/glibce-2.0/glib
VFORMS_INCLUDE = ${VALACE_PATH}/include/vforms-1.0

LD_DIR = ${VALACE_PATH}/lib

ARCH= arm-mingw32ce
CFLAGS= -g -D_WIN32_IE=0x0400 -I ${GOBJECT_INCLUDE} -I ${GLIB_INCLUDE} -I ${VFORMS_INCLUDE} -L${LD_DIR}
LIBS = -lvforms -lglibce-2.0 -lgobject-2.0 -lgthread-2.0 -lcommctrl
CC= ${ARCH}-gcc ${CFLAGS}

example1.exe: example1.c
	${CC} -o $@ $? ${LIBS}

example1.c: example1.vala
	valac -C --vapidir ${VAPIDIR} --pkg windows --pkg vforms-1.0 $?

clean:
	-rm -f *.c *.o *.exe

}}}



= Program source =

Now create and edit a vala source with the name *example1.vala* always inside the same folder.

This is the program source

{{{
/* first simple example */

using VForms;
using Windows;

static int WinMain(Instance instance, Instance prev_instance, StringW? args, int show_mode)
{
	VForms.init (instance);
	MessageBox.show ("Hello ValaCE!", "ValaCE Example");
	return VForms.loop_run ();
}
}}}

Compile it with _make_ and copy the required files to the device. If you want can modify the *ce-deploy* script found in the valaforms subfolder of the source distribution.

Enjoy!